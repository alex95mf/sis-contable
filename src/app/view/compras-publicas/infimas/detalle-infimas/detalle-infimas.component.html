<div class="mt-2">
    <div class="row m-0">
        <div class="col-12">
            <fieldset class="border card-fieldset">
                <legend class="w-auto card-legend">Infirmas</legend>

                <div class="row m-0">

                    <div class="col-12 col-md-12 pt-0 pb-0">

                        <app-cc-input-group-prepend label="Numero de solicitud(No. Oficio)" styleSpan="size-span-campo font-weight-bold">
                            <input type="text" class="form-control form-control-sm" [(ngModel)]="item.num_solicitud" readonly>
                        </app-cc-input-group-prepend>

                    </div>
                </div>

                <div class="row m-0">

                    <div class="col-12 col-md-12 pt-0 pb-0">
                        <app-cc-input-group-prepend label="Descripción" styleSpan="size-span-campo font-weight-bold">
                            <textarea [(ngModel)]="item.descripcion" class="form-control" readonly rows="4">

                            </textarea>
                        </app-cc-input-group-prepend>

                    </div>
                </div>
                <div class="row m-0">
                    <div class="col-12">
                        <nav class="card-k p-2 mb-2">
                            <div class="nav nav-tabs border-0" id="nav-tab" role="tablist">
                                <a class="tab-label text-center active" id="nav-datos-tab" data-toggle="tab" href="#nav-datos" role="tab"
                                    aria-controls="nav-datos" aria-selected="true">Datos</a>
                                <a class="tab-label text-center" id="nav-proveedor-tab" data-toggle="tab" href="#nav-proveedor" role="tab"
                                    aria-controls="nav-proveedor" aria-selected="false">Proveedor</a>
                                <a class="tab-label text-center" id="nav-documentos-tab" data-toggle="tab" href="#nav-documentos" role="tab"
                                    aria-controls="nav-documentos" aria-selected="false">Documentación Final</a>
                            </div>
                        </nav>
                        <div class="tab-content mb-3" id="nav-tabContent">
                            <div class="tab-pane fade show active" id="nav-datos" role="tabpanel" aria-labelledby="nav-datos-tab">
                    
                                <fieldset class="border card-fieldset">
                                    <div class="row m-0">
                                        <div class="col-12 text-right">
                                            <button class="btn btn-success" (click)="validaDatosInfimas()">
                                                Guardar Datos
                                            </button>
                                        </div>
                                    </div>
                    
                                    <div class="row m-0">
                                        <div class="col-12 col-md-6 pt-0 pb-0">
                    
                                            <app-cc-input-group-prepend label="Memo de compras Públicas/Oficio de Publicación" styleSpan="size-span-campo font-weight-bold">
                                                <input type="text" class="form-control form-control-sm" [(ngModel)]="datosInfimas.inf_num_oficio" maxlength="30">
                                            </app-cc-input-group-prepend>
                                        </div>
                                        <div class="col-12 col-md-6 pt-0 pb-0">
                                            <app-cc-input-group-prepend label="Fecha Publicación" styleSpan="font-weight-bold size-span-campo">
                                                <input id="fecha_publicacion" type="date" class="form-control" [(ngModel)]="datosInfimas.inf_fecha_publicacion">
                                            </app-cc-input-group-prepend>
                                        </div>
                                    </div>
                                    <div class="row m-0">
                                        <div class="col-12 col-md-6 pt-0 pb-0">
                    
                                            <app-cc-input-group-prepend label="Nro Sumilla" styleSpan="font-weight-bold size-span-campo">
                                                <input type="text" class="form-control form-control-sm" [(ngModel)]="datosInfimas.inf_num_sumilla" maxlength="30">
                                            </app-cc-input-group-prepend>
                    
                                        </div>
                                        <div class="col-12 col-md-6 pt-0 pb-0">
                    
                                            <app-cc-input-group-prepend label="Cod. SERCOP" styleSpan="font-weight-bold size-span-campo">
                                                <input type="text" class="form-control form-control-sm" [(ngModel)]="datosInfimas.inf_cod_sercop" maxlength="30">
                                            </app-cc-input-group-prepend>
                    
                     
                                        </div>
                                    </div>
                                    <div class="row m-0">
                    
                                        <div class="col-12 col-md-6 pt-0 pb-0">
                                            <app-cc-input-group-prepend label="Fecha Recepción" styleSpan="font-weight-bold size-span-campo">
                                                <input id="fecha_recepcion" type="date" class="form-control" [(ngModel)]="datosInfimas.inf_fecha_recepcion">
                                            </app-cc-input-group-prepend>
                                        </div>
                    
                                        <div class="col-12 col-md-6 pt-0 pb-0">
                                            <app-cc-input-group-prepend label="ICP" styleSpan="font-weight-bold size-span-campo">
                                                <input type="text" class="form-control form-control-sm" readonly
                                                [(ngModel)]="datosInfimas.icp">
                                            </app-cc-input-group-prepend>
                    
                                        </div>
                                    </div>
                                    <div class="row m-0">
                                        <div class="col-12 col-md-6 pt-0 pb-0">
                                            <app-cc-input-group-prepend label="IDP" styleSpan="font-weight-bold size-span-campo">
                                                <input type="text" class="form-control form-control-sm" readonly
                                                        [(ngModel)]="datosInfimas.idp">
                                            </app-cc-input-group-prepend>
                                        </div>
                    
                    
                    
                    
                                    </div>
                                    <div class="row m-0">
                                        <div class="col-12 col-md-6 pt-0 pb-0">
                    
                                            <app-cc-input-group-prepend label="Cuadro Comparativo" styleSpan="font-weight-bold size-span-campo">
                                                <div class="custom-file">
                                                    <input type="file" class="custom-file-input" id="inputGroupFile01" accept=".xlsx, .xls"
                                                        (change)="cargaArchivo($event.target.files)"
                                                        disabled="disabledCampo">
                                                    <label class="custom-file-label" for="inputGroupFile01">{{ fileList !== undefined ?
                                                        fileList[0].name : "Seleccione un archivo" }}</label>

                                                </div> 
                                                <button disabled="formReadOnly" class="btn btn-primary btn-sm" (click)="guardarArchivo()" placement="bottom" ngbTooltip="Guardar Archivo">
                                                    Guardar
                                                 </button>
                                            </app-cc-input-group-prepend>
                    
                                        </div>
                                        <div class="col-12 col-md-6 pt-0 pb-0">
                                            <app-anexos-list-dis [identifier]="item.id_solicitud" custom1="INF-DATOS"></app-anexos-list-dis>
                                        </div>
                                    </div>
                                </fieldset>
                    
                    
                      
                                
                            </div>
                    
                            <div class="tab-pane fade" id="nav-proveedor" role="tabpanel" aria-labelledby="nav-proveedor-tab">
                                <fieldset class="border card-fieldset">
                                    <div class="row m-0">
                                        <div class="text-right col-12">
                                            <button *ngIf="datosInfimas.inf_adjudicado=='S' || adjudList.value=='S'" disabled="deshabilitar" class="btn btn-warning btn-md mt-2 mb-3 pb-2"  placement="bottom" ngbTooltip="Generar orden" (click)="generarOrden()">Generar Orden</button>
                                            <button *ngIf="datosInfimas.inf_adjudicado=='N' || adjudList.value=='N' || datosInfimas.inf_adjudicado=='P' || adjudList.value=='P'"class="btn btn-success btn-md mt-2 mb-3 pb-2 ml-1" (click)="generarOrden()">Guardar</button>
                                            <button *ngIf="datosInfimas.inf_adjudicado=='S' || adjudList.value=='S'" disabled="deshabilitarReporte" class="btn btn-primary btn-md mt-2 mb-3 pb-2 ml-1"  placement="bottom" ngbTooltip="Imprimir orden" (click)="imprimirOrden()">Imprimir</button>
                                        </div>
                                        
                                    </div>



                                        <div class="row m-0">


      
                                            
                                            <div class="col-12 col-md-6 pt-0 pb-0">

                                                




                                                <app-cc-input-group-prepend label="Orden de Compra" styleSpan="font-weight-bold size-span-campo">
                                                    <div class="custom-file">
                                                        <input type="file" class="custom-file-input" id="inputGroupFile03" accept=".pdf"
                                                            (change)="cargaArchivo4($event.target.files)"
                                                            disabled="disabledCampoOC">
                                                        <label class="custom-file-label" for="inputGroupFile03">{{ fileList4 !== undefined ?
                                                            fileList4[0].name : "Seleccione un archivo" }}</label>
     
                                                    
                                                    </div>
                                                   
                                                        <button class="btn btn-sm btn-secondary" (click)="uploadFile4()" 
                                                        disabled='disabledCampoOC'>Cargar</button>
                                                 
         
                                                
                                                </app-cc-input-group-prepend>
                                            </div>
                                            <div class="col-12 col-md-6 pt-0 pb-0">
                                                <app-anexos-list-dis [identifier]="item.id_solicitud" custom1="INF-PROVEEDOR"></app-anexos-list-dis>
                                            </div>
                                    </div>

                                    <div class="row m-0">
                                        <div class="col-12 col-md-6 pt-0 pb-0">
                                            <app-cc-input-group-prepend label="Adjudicación" styleSpan="size-span-campo font-weight-bold">
                                                <ng-select  class="form-control custom" appendTo="body" [searchable]="true" 
                                                 [(ngModel)]="datosInfimas.inf_adjudicado">
                                                <ng-option  [value]= "0" disabled>Chosee.. </ng-option>
                                                <ng-option *ngFor="let item of adjudList"  [value]="item.value">{{item.label}}</ng-option>
                                                </ng-select>
                                            </app-cc-input-group-prepend>
                                        </div>
                                        <div class="col-12 col-md-6 pt-0 pb-0">
                                            <app-cc-input-group-prepend label="No. Orden" styleSpan="font-weight-bold size-span-campo">
                                                <input id="inf_num_orden" type="text" class="form-control form-control-sm" [(ngModel)]="datosInfimas.inf_num_orden" readonly>
                                            </app-cc-input-group-prepend>
                                        </div>

                                        </div>

                                  
                          
                               
 

  
                    
                                <section *ngIf="datosInfimas.inf_adjudicado=='S' || adjudList.value=='S'">
                    
                                    <div class="row m-0">
                                        <div class="col-12 col-md-6 pt-0 pb-0">

                                            <app-cc-input-group-prepend label="Proveedores" styleSpan="size-span-campo font-weight-bold">
                                                <input type="text" class="form-control form-control-sm" disabled placeholder="Seleccione un Proveedor" (click)="expandListProveedores()" [(ngModel)]="proveedorActive.razon_social">
                                                <button disabled="formReadOnly" class="btn btn-primary btn-sm" (click)="expandListProveedores()" placement="bottom" ngbTooltip="Buscar Proveedor">
                                                    <i class="fas fa-search"></i>
                                                </button>

                                            </app-cc-input-group-prepend>

                                        </div>

                                        <div class="col-12 col-md-6 pt-0 pb-0">

                                            <app-cc-input-group-prepend label="Admin de Compra" styleSpan="size-span-campo font-weight-bold">
                                                <input type="text" class="form-control form-control-sm" disabled placeholder="Seleccione un Admin Compra" (click)="expandListAdminCompra()" [value]="adminActive" [(ngModel)]="adminActive.nombre">
                                                <button disabled="formReadOnly" class="btn btn-primary btn-sm" (click)="expandListAdminCompra()" placement="bottom" ngbTooltip="Buscar Admin de Compra">
                                                    <i class="fas fa-search"></i>
                                                </button>

                                            </app-cc-input-group-prepend>

                                        </div>

                                    </div>
                                    <div class="row m-0">

                                        <div class="col-12 col-md-6 pt-0 pb-0">
                                            <app-cc-input-group-prepend label="Fecha" styleSpan="font-weight-bold size-span-campo">
                                                <input id="fecha" type="date" class="form-control form-control-sm" [(ngModel)]="datosInfimas.inf_proveedor_fecha">
                                            </app-cc-input-group-prepend>
                                        </div>
                                    </div>
                                    <div class="row m-0">
                                        <div class="col-12 col-md-6 pt-0 pb-0">

                                            <app-cc-input-group-prepend label="Valor Adjudicado" styleSpan="font-weight-bold size-span-campo">
                                                <input currencyMask class="form-control form-control-sm" [(ngModel)]="datosInfimas.inf_valor" maxlength="16">
                                            </app-cc-input-group-prepend>
                            
                                        </div>
                                        <div class="col-12 col-md-6 pt-0 pb-0">
                                            <app-cc-input-group-prepend label="Cod. Necesidad" styleSpan="font-weight-bold size-span-campo">
                                                <input type="text" class="form-control form-control-sm" [(ngModel)]="datosInfimas.inf_cod_necesidad" maxlength="50">
                                            </app-cc-input-group-prepend>

                                        </div>
                                    </div>
                                   
                                </section>
                                <section *ngIf="datosInfimas.inf_adjudicado=='N' || adjudList.value=='N'">
                                      
                                    <div class="row mt-2 mb-3">
                                        <div class="col-sm-8">
                                            <div class="input-group input-group-sm mt-2">
                                                <div class="input-group-prepend">
                                                    <span class="input-group-text font-weight-bold size-span-campo" id="inputGroup-sizing-sm">Observaciones</span>
                                                </div>
                                                <textarea id="observaciones" type="text" class="form-control form-control-sm" placeholder="Observaciones" [(ngModel)]="datosInfimas.inf_adj_observaciones"  maxlength="300"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                </section>
                                </fieldset>
                            </div>
                    
                            <div class="tab-pane fade" id="nav-documentos" role="tabpanel" aria-labelledby="nav-documentos-tab">
                                <fieldset class="border card-fieldset">
                                    <div class="row m-0">
                                        <div class="text-right col-12">
                                            <button class="btn btn-success" (click)="guardarInfimaDocFinal()">
                                                Guardar
                                            </button>
                                        </div>

                                    </div>
                                        
                                <div class="row m-0">
                                    <div class="col-12 col-md-6 pt-0 pb-0">
                                        <app-cc-input-group-prepend label="Acta de Entrega y Recepción" styleSpan="font-weight-bold size-span-campo">
                                        
                                            <div class="custom-file">
                                                <input type="file" class="custom-file-input" id="inputGroupFile01" accept=".pdf"
                                                    (change)="cargaArchivo2($event.target.files)"
                                                    disabled="disabledCampoCM">
                                                <label class="custom-file-label" for="inputGroupFile01">{{ fileList2 !== undefined ?
                                                    fileList2[0].name : "Seleccione un archivo" }}</label>
                                            </div>
                                        
                                        </app-cc-input-group-prepend>


     
                                    </div>
                    
                                    <div class="col-12 col-md-6 pt-0 pb-0">
                                        <app-anexos-list-dis [identifier]="item.id_solicitud" custom1="INF-ACTAENTREGA"></app-anexos-list-dis>
                                    </div>
                                </div>
                                
                                <div class="row m-0">
                                    <div class="col-12 col-md-6 pt-0 pb-0">
                                        <app-cc-input-group-prepend label="Factura" styleSpan="font-weight-bold size-span-campo">
                                            <div class="custom-file">
                                                <input type="file" class="custom-file-input" id="inputGroupFile02" accept=".pdf"
                                                    (change)="cargaArchivo3($event.target.files)"
                                                    disabled="disabledCampoCP">
                                                <label class="custom-file-label" for="inputGroupFile02">{{ fileList3 !== undefined ?
                                                    fileList3[0].name : "Seleccione un archivo" }}</label>
                                            </div>

                                        </app-cc-input-group-prepend>

                                    </div>
                    
                                    <div class="col-12 col-md-6 pt-0 pb-0">
                                        <app-anexos-list-dis [identifier]="item.id_solicitud" custom1="INF-FACTURA"></app-anexos-list-dis>
                                    </div>
                                </div>
                                <div class="row m-0">
                                    <div class="col-12 col-md-6 pt-0 pb-0">
                                        <app-cc-input-group-prepend label="Cuenta Bancaria" styleSpan="font-weight-bold size-span-campo">
                                            <input type="text" class="form-control form-control-sm" [(ngModel)]="datosInfimas.inf_cuenta_bancaria" (keypress)="validaciones.numberOnlyDot($event)">
                                        </app-cc-input-group-prepend>

                                    </div>
                                    <div class="col-12 col-md-6 pt-0 pb-0">
                                        <app-cc-input-group-prepend label="Obervación" styleSpan="font-weight-bold size-span-campo">
                                            <textarea id="observaciones" type="text" class="form-control form-control-sm" placeholder="Observación" [(ngModel)]="datosInfimas.inf_final_observaciones"  maxlength="300"></textarea>
                                        </app-cc-input-group-prepend>
   
                                    </div>
                                </div>

                                </fieldset>







                                
                                


                            </div>
                        </div>
                    </div>
 

                </div>


            </fieldset>
        </div>
    </div>









        <div class="row m-0">
            <div class="col-12">
                <fieldset class="border card-fieldset">
                    <legend class="w-auto card-legend">Detalle de Solicitud</legend>
                    <div class="row m-0">

                        <div class="col-12 text-right">
                            <button class="btn btn-primary" (click)="validaDetallesInfimas()" disabled="disabledDetalle">
                                Guardar Detalle
                            </button>
                        </div>
                    </div>

                    <div class="row m-0">
                        <div class="col-12">
                            <div class="table-responsive">
                                <table class="table table-striped table-bordered table-k table-hover" >
                                    <thead class="sticky-header">
                                        <tr class="text-center">
                                            <th class="text-center">Descripción</th>
                                            <th class="text-center">Stock</th>
                                            <th class="text-center">Cantidad Requerida</th>
                                            <th class="text-center">Precio Unitario</th>
                                            <th class="text-center">Precio Cotizado</th>
                                            <th class="text-center">Cantidad Aprobada</th>
                                            <th class="text-center">Precio Unitario Aprobado</th>
                                            <th class="text-center">Precio Aprobado</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngIf="!infimasDetalles.length">
                                            <td colspan="5" class="text-center">
                                                <h6>No hay detalles que mostrar</h6>
                                            </td>
                    
                                        </tr>
                                        <tr *ngFor="let item of infimasDetalles, let i = index">
                                            <td class="text-center">{{item.descripcion}}</td>
                                            <td class="text-center">{{item.cantidad_solicitada}}</td>
                                            <td class="text-center">{{item.cantidad_requerida}}</td>
                                            <td class="text-right">${{item.bienes?.costo_unitario | number :'1.2-2'}}</td>
                                            <td class="text-right">${{item.precio_cotizado | number :'1.2-2'}}</td>
                                            <td class="text-right" >
                                                <!-- <div  *ngIf="disabledDetalle">
                                                    {{item.cantidad_aprobada }} 
                                                </div> -->
                                                <div class="input-group input-group-sm" >
                                                    <input type="text" class="form-control form-control-sm text-right"
                                                         [(ngModel)]="item.cantidad_aprobada" (ngModelChange)="calcularTotalAprobado()" (keypress)="onlyNumber($event)">
                                                </div>
                                            </td>
                                            <td class="text-right" >
                                                <!-- <div  *ngIf="disabledDetalle">
                                                    $ {{item.precio_unitario_aprobado  | number :'1.2-2'}} 
                                                </div> -->
                                                <div class="input-group input-group-sm" >
                                                    <div class="input-group-prepend"><span
                                                            class="input-group-text font-weight-bold">$</span></div>
                                                    <input currencyMask type="text" class="form-control form-control-sm text-right"
                                                         [(ngModel)]="item.precio_unitario_aprobado"  (ngModelChange)="calcularTotalAprobado()">
                                                </div>
                                            </td>
                                            <td class="text-right">
                                                <!-- <div  *ngIf="disabledDetalle">
                                                    $ {{item.precio_aprobado  | number :'1.2-2'}} 
                                                </div> -->
                                                <div class="input-group input-group-sm" >
                                                    <div class="input-group-prepend"><span
                                                            class="input-group-text font-weight-bold">$</span></div>
                                                    <input currencyMask type="text" class="form-control form-control-sm text-right"
                                                         [(ngModel)]="item.precio_aprobado" readonly>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <th colspan="4" style="font-size: 14px; " class="font-weight-bold text-right">TOTAL COTIZADO: </th>
                                            <th style=" font-size: 14px;" class="font-weight-bold text-right">$ {{ totalCotizado| number: '1.2-2'}}</th>
                                            <!-- <th style=" font-size: 14px;" class="font-weight-bold text-center">$ {{totalValorSolicitud | number: '1.2-2'}}</th> -->
                                            <th colspan="2" style="font-size: 14px; " class="font-weight-bold text-right">TOTAL APROBADO: </th>
                                            <th style=" font-size: 14px;" class="font-weight-bold text-right">$ {{totalAprobado| number: '1.2-2'}}</th>
            
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>


                </fieldset>


            </div>
        </div>




           
         


   


       



                </div>

    <cc-spiner-procesar [ltexto]="mensajeSpinner" lfulScren=true lTipo="lInfimas"></cc-spiner-procesar>



