<link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0" />
<div class="">
    <app-button-radio-active-new titulo="Mayor de cuentas" filtroBoton="btnsRmovContable" cstyle="bg-gradient-primary text-white" [groupButton]="vmButtons" (onMetodoGlobal)="metodoGlobal($event)" icono="fa fa-medium">
        <div class="row">
            <div class="col-12">
                <fieldset class="border card-fieldset">
                    <legend class="w-auto card-legend">Filtros</legend>
                    <div class="row m-0">
                        <div class="col-12 col-md-6 pt-0 pb-0">
                            <app-cc-input-group-prepend label="Desde" styleSpan="size-span-campo font-weight-bold">
                                <input type="date" class="form-control" [(ngModel)]="fromDatePicker" max="2050-12-31">
                            </app-cc-input-group-prepend>
                        </div>
                        <div class="col-12 col-md-6 pt-0 pb-0">
                            <app-cc-input-group-prepend label="Hasta" styleSpan="size-span-campo font-weight-bold">
                                <input type="date" class="form-control" [(ngModel)]="toDatePicker" max="2050-12-31">
                            </app-cc-input-group-prepend>
                        </div>
                    </div>
                    <div class="row m-0">
                        <div class="col-12 col-md-6 pt-0 pb-0">
                            <div class="input-group input-group-sm mt-1">
                                <div class="input-group-prepend">
                                    <span class="input-group-text size-span-campo" id="inputGroup-sizing-sm">Código desde:</span>
                                </div>
                                <input [(ngModel)]="codigo"  type="text" class="form-control" placeholder="Código cuenta" >
                                <div class="input-group-append">
                                    <button (click)="onClicConsultaPlanCuentas(content)" class="btn btn-action" type="button">
                                        <i class="fa fa-search"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md-6 pt-0 pb-0">
                            <div class="input-group input-group-sm mt-1">
                                <div class="input-group-prepend">
                                    <span class="input-group-text size-span-campo" id="inputGroup-sizing-sm">Nombre
                                        Cuenta:</span>
                                </div>
                                <input type="text" #nameAccountM="ngModel" name="nameAccountM"
                                    [(ngModel)]="nombre" class="form-control form-control-sm"
                                    [disabled]="true" placeholder="Nombre cuenta mayor">
                            </div>
                        </div>
                    </div>
                    <div class="row m-0">
                        <div class="col-12 col-md-6 pt-0 pb-0">
                            <div class="input-group input-group-sm mt-1">
                                <div class="input-group-prepend">
                                    <span class="input-group-text size-span-campo" id="inputGroup-sizing-sm">Cuenta hasta:</span>
                                </div>
                                <input [(ngModel)]="codigo_hasta"  type="text" class="form-control" placeholder="Código cuenta" >
                                <div class="input-group-append">
                                    <button (click)="onClicConsultaPlanCuentasHasta(content)" class="btn btn-action" type="button">
                                        <i class="fa fa-search"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md-6 pt-0 pb-0">
                            <div class="input-group input-group-sm mt-1">
                                <div class="input-group-prepend">
                                    <span class="input-group-text size-span-campo" id="inputGroup-sizing-sm">Nombre
                                        Cuenta:</span>
                                </div>
                                <input type="text" #nameAccountM="ngModel" name="nameAccountM"
                                    [(ngModel)]="nombre_hasta" class="form-control form-control-sm"
                                    [disabled]="true" placeholder="Nombre cuenta mayor">
                            </div>
                        </div>
                    </div>
                    <div class="row m-0 d-none">
                        <div class="col-12 col-md-6 pt-0 pb-0">
                            <div class="input-group input-group-sm mt-1">
                                <div class="input-group-prepend">
                                    <span class="input-group-text size-span-campo font-weight-bolder" id="inputGroup-sizing-sm">Tipo</span>
                                </div>
                                <select class="form-control form-control-sm custom-select " (ngModelChange)="filterTipo($event)" [(ngModel)]="tipo">
                                    <option [value]="0">Seleccione Tipo</option>
                                    <option *ngFor="let d of arrayTipo" [value]="d.codigo">{{ d.codigo }} </option>
                                    </select>
                            </div>
                        </div>
                        <div class="col-12 col-md-6 pt-0 pb-0">
                            <div class="input-group input-group-sm mt-1">
                                <div class="input-group-prepend ">
                                    <span class="input-group-text size-span-campo font-weight-bold" id="">Número</span>
                                </div>
                                <select class="form-control form-control-sm custom-select" (ngModelChange)="filterNumero($event)" [disabled]=" tipo == 0" [(ngModel)]="numero">
                                    <option [value]="0">Seleccione Numero</option>
                                    <option *ngFor="let d of arrayCab" [value]="d.num_doc">{{ d.num_doc.padStart(10, 0)}} </option>
                                    </select>
                            </div>
                        </div>
                    </div>
                    <div class="row m-0 d-none">
                        <div class="col-12 col-md-6 pt-0 pb-0">
                            <div class="input-group input-group-sm mt-1">
                                <div class="input-group-prepend">
                                    <span class="input-group-text size-span-campo font-weight-bolder" id="inputGroup-sizing-sm">Actual</span>
                                </div>
                                <input type="text" [(ngModel)]="actual" disabled class="form-control  form-control-sm text-right">
                            </div>
                        </div>
                        <div class="col-12 col-md-6 pt-0 pb-0">
                            <div class="input-group input-group-sm mt-1">
                                <div class="input-group-prepend">
                                    <span class="input-group-text size-span-campo font-weight-bolder" id="inputGroup-sizing-sm">Anterior</span>
                                </div>
                                <input type="text" [(ngModel)]="anterior" disabled class="form-control form-control-sm text-right">
                            </div>
                        </div>
                    </div>
                    <div class="row justify-content-center d-none">
                        <div class="col-12">
                            <div class="row m-0">
                                <div class="col-12 col-md-3 pt-0 pb-0">
                                    <div class="input-group input-group-sm mt-1">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text size-span-otro font-weight-bolder" id="inputGroup-sizing-sm">Código</span>
                                        </div>
                                        <ng-select class="form-control custom" appendTo="body" [searchable]="true" style="padding-left: 7px;font-size: 13px;"
                                         [(ngModel)]="codigo" 
                                         (ngModelChange)="filterCodigo($event)" 
                                         [clearable]="false">
                                            <ng-option [value]="0">Seleccione Codigo</ng-option>
                                            <ng-option *ngFor="let d of arrayCodigo" [value]="d.codigo"> {{d.codigo}}</ng-option>
                                        </ng-select>
                                    </div>
                                </div>
                            </div>
                            <div class="row m-0">
                                <div class="col-12 col-md-3 pt-0 pb-0">
                                    <div class="input-group input-group-sm mt-1">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text size-span-otro font-weight-bolder" id="inputGroup-sizing-sm">Nombre</span>
                                        </div>
                                        <ng-select class="form-control custom" appendTo="body" [searchable]="true" style="padding-left: 7px;font-size: 13px;" [(ngModel)]="nombre" (ngModelChange)="filterNombre($event)" [clearable]="false">
                                            <ng-option [value]="0">Seleccione Nombre</ng-option>
                                            <ng-option *ngFor="let d of arrayNombre" [value]="d.nombre"> {{d.nombre}}</ng-option>
                                        </ng-select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </fieldset>
            </div>
        </div>


        <div class="row">
            <div class="col-12">
                <fieldset class="border card-fieldset">
                    <legend class="w-auto card-legend">Cuentas</legend>
                    <div class="row m-0">
                        <div class="col-12">
                            <p-table 
                            [value]="infomovData" 
                            sortField="nom_cuenta" 
                            sortMode="single" 
                            [scrollable]="true" 
                            scrollHeight="500px" 
                            rowGroupMode="subheader" 
                            groupRowsBy="codigo" 
                            style="width:100%;"
                            class="table table-striped table-k table-hover">
                            <ng-template pTemplate="header" class="p-datatable-header">
                                <tr>
                                    <th style="width: 10%">Fecha</th>
                                    <th>Cuenta</th>
                                    <th>Tipo</th>
                                    <th>Asiento</th>
                                    <th>Numero</th>
                                    <th>Detalle</th>
                                    <th>Centro de Costo</th>
                                    <th>Debe</th>
                                    <th>Haber</th>
                                    <th>Saldo</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="groupheader" let-dt>
                                <tr pRowGroupHeader style="top: 50px;height: 50px;background: #dce0e3;font-size: 14px;">
                                    <td colspan="4">
                                        <span class="font-bold ml-2">{{dt.codigo}} - {{dt.nom_cuenta}} </span>
                                    </td>
                
                                    <td colspan="3">
                                        <!-- <span class="font-bold ml-2">Saldo Anterior: {{dt.saldo_antes | number:'1.2-2'}}</span> -->
                                        <span class="font-bold ml-2">Saldo Anterior: {{dt.saldo_inicial | number:'1.2-2'}}</span>
                                    </td>
                                </tr>
                            </ng-template>
                            <ng-template style="height: 35px;" pTemplate="groupfooter" let-dt >
                                <tr style="font-size: 14px;" >
                                    <td colspan="7" class="text-right font-bold pr-6">Saldo Final: {{dt.saldo | number:'1.2-2'}}</td>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-dt let-rowIndex="rowIndex">
                                <tr style="font-size: 11px;">
                                    <td>
                                        {{dt.fecha}}
                                    </td>
                                    <td>
                                        {{dt.codigo}}
                                    </td>
                                    <td>
                                        {{dt.nombre}}
                                    </td>
                                    <td>
                                        {{dt.asiento}}
                                    </td>
                                    <td>
                                        <span style="text-decoration: underline;  color: #2b94e2; " class="cursor-pointer font-bold" (click)="consultaDetalleDocumento(dt)">
                                            {{dt.ref_num_doc}}
                                        </span>
                                    </td>
                                    <td>
                                        {{dt.glosa}}
                                    </td>
                                    <td>
                                        {{dt.centro_costo}}
                                    </td>
                                    <td class="td_gerenarl text-right">
                                        $ {{ dt.valor_deb | number:'1.2-2'}}
                                    </td>
                                    <td class="td_gerenarl text-right">
                                        $ {{ dt.valor_cre | number:'1.2-2'}}
                                    </td>
                                    <td class="td_gerenarl text-right">
                                        $ {{ dt.saldo | number:'1.2-2'}}
                                    </td>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="emptymessage">
                                <tr class="text-center">
                                    <td class="EmptyTable text-center" [attr.colspan]="10">
                                        No hay información para mostrar
                                    </td>
                                </tr>
                            </ng-template>
                            </p-table>
                        </div>
                    </div>
                </fieldset>
            </div>
        </div>
       

        <!-- <p-table 
            [value]="infomovData" 
            sortField="nom_cuenta" 
            sortMode="single" 
            [scrollable]="true" 
            scrollHeight="500px" 
            rowGroupMode="subheader" 
            groupRowsBy="codigo" 
            style="width:100%;">
            <ng-template pTemplate="header" >
                <tr style="font-size: 12px;">
                    <th style="width: 10%">Fecha</th>
                    <th>Cuenta</th>
                    <th>Tipo</th>
                    <th>Asiento</th>
                    <th>Numero</th>
                    <th>Detalle</th>
                    <th>Centro de Costo</th>
                    <th>Debe</th>
                    <th>Haber</th>
                    <th>Saldo</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="groupheader" let-dt>
                <tr pRowGroupHeader style="top: 50px;height: 50px;background: #dce0e3;font-size: 14px;">
                    <td colspan="4">
                        <span class="font-bold ml-2">{{dt.codigo}} - {{dt.nom_cuenta}} </span>
                    </td>

                    <td colspan="3">
                        <span class="font-bold ml-2">Saldo Anterior: {{dt.saldo_inicial | number:'1.2-2'}}</span>
                    </td>
                </tr>
            </ng-template>
            <ng-template style="height: 35px;" pTemplate="groupfooter" let-dt >
                <tr style="font-size: 14px;" >
                    <td colspan="7" class="text-right font-bold pr-6">Saldo Final: {{dt.saldo | number:'1.2-2'}}</td>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-dt let-rowIndex="rowIndex">
                <tr style="font-size: 11px;">
                    <td>
                        {{dt.fecha}}
                    </td>
                    <td>
                         {{dt.codigo}}
                    </td>
                    <td>
                         {{dt.nombre}}
                    </td>
                    <td>
                        {{dt.asiento}}
                   </td>
                    <td>
                        <span style="text-decoration: underline;  color: #2b94e2; " class="cursor-pointer font-bold" (click)="consultaDetalleDocumento(dt)">
                            {{dt.ref_num_doc}}
                        </span>
                    </td>
                    <td>
                        {{dt.glosa}}
                    </td>
                    <td>
                        {{dt.centro_costo}}
                    </td>
                    <td class="td_gerenarl text-right">
                        $ {{ dt.valor_deb | number:'1.2-2'}}
                    </td>
                    <td class="td_gerenarl text-right">
                        $ {{ dt.valor_cre | number:'1.2-2'}}
                    </td>
                    <td class="td_gerenarl text-right">
                        $ {{ dt.saldo | number:'1.2-2'}}
                    </td>
                </tr>
            </ng-template>
        </p-table> -->

        <!--div class="justify-content-center mt-4 mb-3">
            <div class="filters">               
                <div class="table-responsive content-tabla-general">
                    <table class="table table-bordered table-scroll small-first-col" id="tablaRegistros">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Fecha</th>
                                <th>Documento</th>
                                <th>Cuenta</th>
                                <th>Detalle</th>
                                <th>Debe</th>
                                <th>Haber</th>
                                <th>Saldo</th>
                            </tr>
                        </thead>
                        <tbody *ngIf="infomovData.length > 0 else TablaVacia" style="width: 100%;" class="body-half-screen">
                            <tr *ngFor="let dt of infomovData; let i = index">
                                <td style="width: 10px;" class="td_gerenarl"><span>{{ i + 1 }}</span></td>
                                <td class="text-center td_gerenarl" style="width: 80px;">
                                    <span>{{dt.fecha}}</span>
                                </td>
                                <td style="width: 80px;" class="td_gerenarl link-modal-access"  (click)="viewAsiento(dt)"><span>{{ dt.codigodoc }}-{{ dt.num_doc.padStart(10, 0)}}</span></td>
                                <td style="width: 80px;" class="td_gerenarl">
                                    <span>{{ dt.nom_cuenta }}</span>
                                </td>
                                <td style="width: 180px;" class="td_gerenarl">
                                    <span>{{ dt.detalle }}</span>
                                </td>
                                <td style="width: 80px;" class="text-right  td_gerenarl">
                                    <span>{{ formatNumber(dt.valor_deb)}}</span>
                                </td>
                                <td style="width: 80px;" class="text-right td_gerenarl" >
                                    <span>{{ formatNumber(dt.valor_cre)}}</span>
                                </td>
                                <td style="width: 80px; background: #ebebeb;" class="td_gerenarl text-right">
                                    <span><strong>{{ formatNumber(dt.saldo) }}</strong></span>
                                </td>
                            </tr>
                        </tbody>

                        <ng-template #TablaVacia>
                            <tbody>
                                <tr class="body-empty"  >
                                    <td colspan="7" >no hay datos para mostrar</td> 
                                </tr>
                            </tbody>
                        </ng-template>

                    </table>
                </div>
                
                <div class="row justify-content-center ">
                    <div class="col-12 pl-3 pr-3 table-responsive responsive-table  ">
                        <table class="table table-sm table-hover content-tabla-general content-tabla_editable">
                            <tfoot>
                                <tr style="width: 100%;">
                                    <td style="width: 10px;"> <strong></strong></td>
                                    <td style="width: 80px;"> <strong></strong></td>
                                    <td style="width: 80px;" class="text-left">
                                        Registros Encontrados
                                    </td>
                                    <td style="width: 80px; " class="text-left">
                                        {{dataTotal.countRegistros}}
                                    </td>
                                    <td style="width: 180px;" class="text-right">
                                        $ {{formatNumber(dataTotal.Debe)}}
                                    </td>
                                    <td style="width: 80px;" class="text-right">
                                        $ {{formatNumber(dataTotal.Haber)}}
                                    </td>
                                    <td style="width: 80px;" class="text-right">
                                        $ {{formatNumber(dataTotal.Saldo)}}
                                    </td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>
        </div-->
    </app-button-radio-active-new>
</div>
<cc-spiner-procesar [ltexto]="mensajeSppiner" lfulScren=true lTipo="spContMov"></cc-spiner-procesar>


<div [hidden]="true" id="print-section-contable" *ngIf="dataSucursal != undefined">

    <div class="row justify-content-center  prt-movCont">
        <div class="col-11 pl-2 pr-2 ">
            <div class="row justify-content-center">
                <div class="col-md-5 text-center mt-5">
                    <div class="sect-one pt-3 pb-3">
                        <div class="row justify-content-center">
                            <div class="col-md-12 mt-4">
                                <img src="{{empresLogo}}" alt="" style="width: 200px;">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-7 text-center mt-5">
                    <div class="sect-two pt-3 pb-2">
                        <div class="row justify-content-center">
                            <div class="col-md-12 mt-4" style="font-size: 20px;font-weight: bold">
                                <h3>Mayor de cuentas</h3>
                                <p> Desde:{{fromDatePicker | date:'shortDate'}}&nbsp;Hasta:{{ toDatePicker | date:'shortDate'}}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-11 mt-4 prt-movCont">
            <div class="row justify-content-center">
                <div class="col-md-3 text-right ">
                    <div style="background-color: #5b9bd5 !important;color: white;font-weight:bold" class="pl-1 pr-1">
                        Saldo Anterior: $ {{anterior}}
                    </div>
                </div>
                <div class="col-md-3 text-right ">
                    <div style="background-color: #5b9bd5 !important;color: white;font-weight:bold" class="pl-1 pr-1">
                        Saldo Actual: $ {{actual}}
                    </div>
                </div>
                <div class="col-md-6 text-center ">
                    <div style="background-color: #5b9bd5 !important;color: white;font-weight:bold" class="pl-1 pr-1">
                        Cuenta Contable: {{codigo}} / {{nombre}}
                    </div>
                </div>
            </div>
        </div>

        <div class="col-11 mt-4 pl-2 pr-2 prt-movCont">
            <div class="row justify-content-center">
                <div class="col-md-12 text-center">
                    <table class="table">
                        <thead>
                            <tr style="width: 100%;">
                                <th style="width: 3%;">#</th>
                                <th style="width: 8%; ">Fecha</th>
                                <th style="width: 10%; ">Documento</th>
                                <th style="width: 30%; ">Detalle</th>
                                <th style="width: 8%; ">Debe</th>
                                <th style="width: 8%; ">Haber</th>
                                <th style="width: 8%; ">Saldo</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let dt of infomovData; let i = index">
                                <td style="border-top: none !important;"><span>{{ i + 1 }}</span></td>
                                <td style="border-top: none !important;">
                                    <span>{{dt.fecha}}</span>
                                </td>
                                <td style="border-top: none !important;" class="text-left">
                                    <span *ngIf="dt.num_doc.length == 1 ">{{ dt.codigoDoc }}-{{ dt.num_doc.padStart(10, 0)}}</span>
                                    <span *ngIf="dt.num_doc.length != 1 ">{{ dt.codigoDoc }}-{{ dt.num_doc }}</span>
                                </td>
                                <td style="border-top: none !important;" class="text-left">
                                    <span>{{ dt.detalle }}</span>
                                </td>
                                <td style="border-top: none !important;">
                                    <div class="text-right">
                                        <span>$ {{ formatNumber(dt.valor_deb)}}</span>
                                    </div>
                                </td>
                                <td style="border-top: none !important;">
                                    <div class="text-right">
                                        <span>$ {{ formatNumber(dt.valor_cre) }}</span>
                                    </div>
                                </td>
                                <td style="border-top: none !important;">
                                    <div class="text-right">
                                        <span>$ {{ formatNumber(dt.saldo) }}</span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="4" style="text-align: right;padding-right: 10px;background-color: #5b9bd5 !important;color: white;">
                                </td>
                                <td style="text-align: right;padding-right: 15px;background-color: #5b9bd5 !important;color: white;">
                                    <span>$ {{formatNumber(dataTotal.Debe)}}</span>
                                </td>
                                <td style="text-align: right;padding-right: 15px;background-color: #5b9bd5 !important;color: white;">
                                    <span>$ {{formatNumber(dataTotal.Haber)}}</span>
                                </td>
                                <td style="text-align: right;padding-right: 15px;background-color: #5b9bd5 !important;color: white;">
                                    <span>$ {{formatNumber(dataTotal.Saldo)}}</span>
                                </td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>

        </div>
    </div>
    <div class="row justify-content-center" style="font-family: 'Poppins1';">
        <div class="col-12 text-left" style="position: fixed;  bottom: 0px; ">
            <span style="color: #13A1EA;">
                Fecha: {{fecha}}&nbsp;{{hora}}</span>
        </div>
        <div class="col-12 text-left" style="position: fixed;  bottom: 20px; ">
            <span style="color: #13A1EA;">
                Usuario: {{dataUser.nombre}}</span>
        </div>
    </div>

    <ng-template #content let-modal class="modal-flotante">
        <div class="modal-header">
            <h5 class="modal-title">BUSQUEDA PLAN CUENTA</h5>
            <button type="button"  class="btn-close butto-close-modal" aria-label="Close" (click)="modal.dismiss('Cross click')">Cerrar</button>
        </div>
        <div class="modal-body body_table_search">
            <app-cc-modal-tabla-cuenta (EventElemntRow)=CargarCuentaEditar($event)></app-cc-modal-tabla-cuenta>
        </div>
    </ng-template>

</div>